## CorrApaptor

### 1. **研究背景与问题**

- **任务**：图像匹配中的离群点剔除（correspondence pruning），用于提升运动恢复结构（SfM）、SLAM等任务的精度。
- **现有方法缺陷**：
  - 传统方法（如RANSAC）在高离群点比例下效率低。
  - 基于学习的方法过度依赖固定邻居数的KNN（如K=9），无法自适应调整局部上下文范围。
  - 隐式方法（如OANet）构建的局部图过于粗糙，导致上下文范围过广。

### 2. **核心创新：CorrAdaptor**

#### 🌟 **双分支结构（Dual-Branch）**

- **显式分支（Explicit Branch）**：
  - 使用KNN构建固定邻居数的局部图（如K=9）。
  - 通过图注意力机制（空间/通道/邻居注意力）聚合特征。
- **隐式分支（Implicit Branch）**：
  - 利用可学习矩阵动态分配邻居（软聚类）。
  - 包含池化层（Pooling）、OA滤波器和反池化层（Unpooling），自适应扩展上下文范围。
- **分支协同**：隐式分支的输出指导显式分支动态调整邻居范围。

#### 🚀 **运动注入模块（Motion Injection Module）**

- **动机**：离群点因随机分布会破坏局部上下文学习。
- **方法**：
  - 引入运动一致性先验（坐标差向量，公式10）。
  - 采用**FlowAttention**[33]（而非传统注意力）：
    - 复杂度从*O*(*N*²*d*)降至*O*(*N**d*²)。
    - 通过竞争机制抑制离群点影响。
  - 结构：多头自注意力（MHSA） + 多头交叉注意力（MHCA）注入运动信息。

### 3. **技术实现**

- **输入**：初始匹配点对集 *C* ∈ *ℝ*^*N*×⁴（归一化坐标）。
- **流程**：
  1. 双分支分别提取局部特征（*Fₑ* 和 *Fᵢ*）。
  2. 运动注入模块迭代 *Lₘ*=2 次，增强特征鲁棒性。
  3. 分支特征融合后，通过线性层预测内点权重，按剪枝率 *α*=0.5 逐步剔除离群点。
- **损失函数**：混合损失（分类损失 + 基础矩阵回归损失）。

### 4. **实验结果**

#### 📊 **SOTA性能（三个数据集）**

- **YFCC100M**（室外）：
  - 匹配任务：F-score **79.67**（比MGNet高1.53）。
  - 位姿估计：AUC@20° **76.98**（比NCMNet高4.58）。
- **SUN3D**（室内）：
  - AUC@20° **40.85**（纹理重复/遮挡场景优势显著）。
- **HPatches**（单应性估计）：
  - AUC@3px **79.23**（领先先前方法1.11）。

#### 🔍 **消融实验关键结论**

- **双分支必要性**：显式+隐式比单分支性能高15.4%。
- **运动注入模块**：移除后AUC@5°下降6.51（表8）。
- **FlowAttention**：比普通注意力AUC@5°高1.49，推理速度更快（表7）。
- **隐式分支聚类数**：250簇时参数量最小（6.57M），性能最优（表6）。

### 5. **贡献总结**

1. **自适应局部上下文**：首提双分支结构动态调整邻居范围。
2. **运动先验抑制离群点**：设计轻量级FlowAttention注入运动一致性。
3. **显著性能提升**：在匹配、位姿估计、单应性估计任务全面超越SOTA。

### 6. **实践启示**

- **适用场景**：适合高离群点比例、动态场景的视觉任务（如SLAM、三维重建）。
- **复现注意**：
  - 运动信息定义为坐标差向量（公式10）。
  - 显式分支KNN邻居数分层设置（首层K=9，次层K=6）。
  - 使用FlowAttention降低计算开销